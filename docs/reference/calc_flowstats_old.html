<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="calc_flowstats uses a time series of measured or modeled flows to calculate a suite of long-term and seasonal (winter and summer) flow statistics for one or more sites (stations). It is primarily designed to work with mean daily flows (e.g. as produced by import_flow), but can also be applied to time series data on a longer (e.g. monthly) time step. Regardless, the data should be regularly spaced and the same time step should be used for all sites."><title>Calculate a suite of long-term and seasonal flow statistics for one or more sites. — calc_flowstats_old • hetoolkit</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate a suite of long-term and seasonal flow statistics for one or more sites. — calc_flowstats_old"><meta property="og:description" content="calc_flowstats uses a time series of measured or modeled flows to calculate a suite of long-term and seasonal (winter and summer) flow statistics for one or more sites (stations). It is primarily designed to work with mean daily flows (e.g. as produced by import_flow), but can also be applied to time series data on a longer (e.g. monthly) time step. Regardless, the data should be regularly spaced and the same time step should be used for all sites."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">hetoolkit</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.1.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>MIXED MODELLING</h6>
    <a class="dropdown-item" href="../articles/Vignette.html">Vignette</a>
    <a class="dropdown-item" href="../articles/CaseStudy1.html">Macroinvertebrates in chalk streams</a>
    <a class="dropdown-item" href="../articles/CaseStudy2.html">Macroinvertebrates in upland rivers</a>
    <a class="dropdown-item" href="../articles/CaseStudy3.html">Macrophytes in chalk streams</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>OTHER METHODS</h6>
    <a class="dropdown-item" href="../articles/CaseStudy4.html">Climwin</a>
    <a class="dropdown-item" href="../articles/CaseStudy5.html">Gradient Forest</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../Resources.html">Resources</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../updates.html">Updates</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../FAQs.html">FAQs</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Calculate a suite of long-term and seasonal flow statistics for one or more sites.</h1>
      
      <div class="d-none name"><code>calc_flowstats_old.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>calc_flowstats uses a time series of measured or modeled flows to calculate a suite of long-term and seasonal (winter and summer) flow statistics for one or more sites (stations). It is primarily designed to work with mean daily flows (e.g. as produced by import_flow), but can also be applied to time series data on a longer (e.g. monthly) time step. Regardless, the data should be regularly spaced and the same time step should be used for all sites.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">calc_flowstats_old</span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, site_col <span class="op">=</span> <span class="st">"flow_site_id"</span>, date_col <span class="op">=</span> <span class="st">"date"</span>, flow_col <span class="op">=</span> <span class="st">"flow"</span>, ref_col <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>data</dt>
<dd><p>Name of data frame or tibble containing the flow data to be processed.
Must be in long format and contain columns for flow site id, date and flow (see output from import_flows).</p></dd>


<dt>date_col</dt>
<dd><p>Name of column in 'data' containing date of flow record.  Default = "date".</p></dd>


<dt>flow_col</dt>
<dd><p>Name of column in 'data' containing flow data for processing. Default = "flow".</p></dd>


<dt>ref_col</dt>
<dd><p>Name of column in 'data' containing flow data for reference scenario against which flow statistics are standardised. Default: NULL.</p></dd>


<dt>sites_col</dt>
<dd><p>Name of column in 'data' containing unique flow site id. Default = "flow_site_id".</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>calc_flowstats returns a list of two data frames. The first data frame contains a suite of time-varying flow statistics for every 6 month winter/summer period at every site. The columns are as follows:</p><ul><li><p>flow_site_id (a unique site id; this is the standardised column header for flow sites)</p></li>
<li><p>season (S = summer, W = winter)</p></li>
<li><p>water_year (year starting 1st October; e.g. 2018 = 01/10/2018 to 30/09/2019)</p></li>
<li><p>Q10: the unstandardised Q10 flow in a 6-month winter or summer period.</p></li>
<li><p>Q30: the unstandardised Q30 flow in a 6-month winter or summer period.</p></li>
<li><p>Q50: the unstandardised Q50 flow in a 6-month winter or summer period.</p></li>
<li><p>Q70: the unstandardised Q70 flow in a 6-month winter or summer period.</p></li>
<li><p>Q90: the unstandardised Q70 flow in a 6-month winter or summer period.</p></li>
<li><p>Q95: the unstandardised Q95 flow in a 6-month winter or summer period.</p></li>
<li><p>Q99: the unstandardised Q99 flow in a 6-month winter or summer period.</p></li>
<li><p>Q10mean: the seasonal (winter or summer) Q10 flow, averaged across years.</p></li>
<li><p>Q10sd: the standard deviation of the seasonal (winter or summer) Q10 flows.</p></li>
<li><p>Q10z: the Q10 flow in a six month period, standardised using the above mean and sd. If ref_col = NULL, then the mean and sd parameters are calculated using the same flow time series (i.e. Q10z = (Q10 - Q10mean) / Q10sd); if not, the mean and sd parameters are calculated from the ref_col flow time series (i.e. Q10z = (Q10 - Q10mean_ref) / Q10sd_ref).</p></li>
<li><p>Q30mean: (as for Q10)</p></li>
<li><p>Q30sd: (as for Q10)</p></li>
<li><p>Q30z: (as for Q10)</p></li>
<li><p>Q50mean: (as for Q10)</p></li>
<li><p>Q50sd: (as for Q10)</p></li>
<li><p>Q50z: (as for Q10)</p></li>
<li><p>Q70mean: (as for Q10)</p></li>
<li><p>Q70sd: (as for Q10)</p></li>
<li><p>Q70z: (as for Q10)</p></li>
<li><p>Q95: (as for Q10)</p></li>
<li><p>Q95mean: (as for Q10)</p></li>
<li><p>Q95sd: (as for Q10)</p></li>
<li><p>Q95z: (as for Q10)</p></li>
<li><p>zero:	Number of zero flow days</p></li>
<li><p>mean:	mean flow</p></li>
<li><p>sd: standard deviation of flows</p></li>
<li><p>lsd: standard deviation of the log flow series</p></li>
<li><p>n:	number of days (182 or 183)</p></li>
<li><p>e3: number of events when flows exceed 3 x the long-term median (Q50) flow</p></li>
<li><p>e5: number of events when flows exceed 5 x the long-term median (Q50) flow</p></li>
<li><p>e7: number of events when flows exceed 7 x the long-term median (Q50) flow</p></li>
<li><p>missing: number of missing records (NAs)</p></li>
<li><p>durationAbove: number of records above the long-term Q70</p></li>
<li><p>nEventsAbove: number of events when flows exceed the long-term Q70</p></li>
<li><p>durationBelow: number of records below the long-term Q95</p></li>
<li><p>nEventsBelow: number of events when flows exceed the long-term Q95</p></li>
<li><p>e3mean: e3, averaged across years</p></li>
<li><p>e5mean: e5, averaged across years</p></li>
<li><p>e7mean: e7, averaged across years</p></li>
<li><p>durationAboveMean: durationAbove, averaged across years</p></li>
<li><p>durationBelowMean: durationBelow, averaged across years</p></li>
<li><p>nEventsAboveMean: nEventsAbove, averaged across years</p></li>
<li><p>nEventsBelowMean: nEventsBelow, averaged across years</p></li>
</ul><p>The second data table contains long-term flow statistics. The data are arranged in long format, with the following columns:</p><ul><li><p>flow_site_id (a unique site id)</p></li>
<li><p>season (S = summer, W = winter, A = all)</p></li>
<li><p>parameter (base flow index (bfi), flow duration curve percentiles (p1 to p99), and seasonal means and standard deviations for Q10, Q30, Q50, Q75 and Q95).</p></li>
<li><p>value (calculated statistic)</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function is hard-wired to exclude any flow data before 1st April 1985.  Must be in long format and contain columns named "flow_site_id", "Date" and "Flow" (see output from import_flows).</p>
<p>Winter is defined as 1st October to 31st March, and Summer as 1st April to 30th September. There is no minimum number of records required in each 6 month period; if desired, the outputs can be filtered afterwards to eliminate potentially unreliable results based on sparse data.</p>
<p>Selected flow percentiles (Q10, Q30, Q50, Q70 and Q95) are calculated for each 6 month winter/summer, and then standardized using the long-term mean and standard deviation of these statistics. If calculating flow statistics for two different flow scenarios (e.g. historical and naturalised), then the function includes the facility to standardise the flow percentile statistics for one scenario (specified via flow_col) using mean and standard deviation of flow statistics from the other scenario (specified via ref_col). For example, if flow_col = naturalised flows and ref_col = historical flows, then the resulting statistics can be input into a hydro-ecological model calibrated using historical flow data and used to make predictions of ecological status under naturalised flows.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Calculate a suite of long-term and seasonal flow statistics for all sites listed in site_col:</span></span></span>
<span class="r-in"><span><span class="co"># calc_flowstats(data = flow_data,</span></span></span>
<span class="r-in"><span><span class="co">#                site_col = "flow_site_id",</span></span></span>
<span class="r-in"><span><span class="co">#                date_col = "date",</span></span></span>
<span class="r-in"><span><span class="co">#                flow_col = "flow")</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Calculate a suite of long-term and seasonal flow statistics for all sites listed in site_col, and standardise QXX flow statistics using flow data specified in ref_col:</span></span></span>
<span class="r-in"><span><span class="co"># calc_flowstats(data = data,</span></span></span>
<span class="r-in"><span><span class="co">#               site_col = "flow_site_id",</span></span></span>
<span class="r-in"><span><span class="co">#               date_col = "date",</span></span></span>
<span class="r-in"><span><span class="co">#               flow_col = "HistoricalFlow",</span></span></span>
<span class="r-in"><span><span class="co">#               ref_col = "NaturalisedFlow")</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Environment Agency, APEM Ltd.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

