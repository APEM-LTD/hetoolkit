<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function imputes (infills) missing records in daily flow time series for one or more sites (gauging stations) using either interpolation or an equipercentile  method. Imputation of missing flow data can improve the later estimation of flow statistics using the calc_flowstats() function and aid the visualisation of hydro-ecological relationships using the plot_hev() function.  Note, although this function provides automated tools for imputing missing records, it is advisable to consult a hydrologist if your data contains extensive/lengthy gaps, to ensure that the methods and results are trustworthy."><title>Impute missing flow data. — impute_flow • hetoolkit</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Impute missing flow data. — impute_flow"><meta property="og:description" content="This function imputes (infills) missing records in daily flow time series for one or more sites (gauging stations) using either interpolation or an equipercentile  method. Imputation of missing flow data can improve the later estimation of flow statistics using the calc_flowstats() function and aid the visualisation of hydro-ecological relationships using the plot_hev() function.  Note, although this function provides automated tools for imputing missing records, it is advisable to consult a hydrologist if your data contains extensive/lengthy gaps, to ensure that the methods and results are trustworthy."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">hetoolkit</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/hetoolkit-vignette.html">hetoolkit-Vignette</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Impute missing flow data.</h1>
      
      <div class="d-none name"><code>impute_flow.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function imputes (infills) missing records in daily flow time series for one or more sites (gauging stations) using either interpolation or an equipercentile  method. Imputation of missing flow data can improve the later estimation of flow statistics using the calc_flowstats() function and aid the visualisation of hydro-ecological relationships using the plot_hev() function.  Note, although this function provides automated tools for imputing missing records, it is advisable to consult a hydrologist if your data contains extensive/lengthy gaps, to ensure that the methods and results are trustworthy.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">impute_flow</span><span class="op">(</span><span class="va">data</span>, site_col <span class="op">=</span> <span class="st">" flow_site_id"</span>, date_col <span class="op">=</span> <span class="st">"date"</span>, flow_col <span class="op">=</span> <span class="st">"flow"</span>, method <span class="op">=</span> <span class="st">"linear"</span>, donor <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>data</dt>
<dd><p>A tibble or data frame containing the flow data to be imputed. Include all sites, not just those with missing data, especially if using the equipercentile method.</p></dd>


<dt>site_col</dt>
<dd><p>Name of column in <code>data</code> containing unique flow site id. Default = "flow_site_id". Site ids are coerced to a character vector.</p></dd>


<dt>date_col</dt>
<dd><p>Name of column in <code>data</code> containing date of flow record. Default = "date".  Dates must be in "yyyy-mm-dd" format.</p></dd>


<dt>flow_col</dt>
<dd><p>Name of column in <code>data</code> containing the measured  flows. Default = "flow".</p></dd>


<dt>method</dt>
<dd><p>Imputation method: "linear" (default), "exponential" or "equipercentile".</p></dd>


<dt>donor</dt>
<dd><p>– A tibble or data frame with at least two columns: the first a list of flow sites requiring imputation, and the second a list of paired donor sites. Subsequent columns are ignored. Default = NULL. Only used when method = "equipercentile".  Note, the date ranges of the donor site and the flow site of interest must overlap by a minimum of 365 records (i.e. 1 year).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A tibble containing the imputed flow data. The data are arranged in long format, with the following columns:</p><ul><li><p>flow_site_id (unique flow site id)</p></li>
<li><p>date (of flow record)</p></li>
<li><p>imputed (flag  indicating whether each flow value is original (0) or imputed (1))</p></li>
<li><p>donor_site (id of donor site used for imputation, if "equipercentile" method used)</p></li>
<li><p>donor_flow (measured flow at donor site on that date, if "equipercentile" method used)</p></li>
<li><p>any other columns in the input dataset are automatically pulled through and joined to the output data table (e.g. the ‘input’ and ‘quality’ columns from the import_flow() function).</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function is intended for imputing gauged daily flow data only; it cannot be used to impute sub-daily data, and is not designed for data on coarser time steps (e.g. 10-daily or monthly).</p>
<p>The function offers three imputation methods: linear interpolation, exponential interpolation and an equipercentile algorithm.</p>
<p>The default <code>linear</code> method uses linear (straight line) interpolation to impute missing flow values. It is therefore unable to infill gaps at the beginning or end of a time series (these flow values remain <code>NA</code>).</p>
<p>The <code>exponential</code> method assumes that flow changes exponentially with time, and so produces imputed values with an accelerating rate of change in flow on the rising limb of the hydrograph, and a decelerating rate of change on the descending limb. Specifically, the flow on day t (Qt) is a function of the flow on the previous day (Qt-1) and the exponential decay constant (λ): Qt = Qt-1 x e-λ. For example, a flow time series with a 3 day gap – <code>10, NA, NA, NA, 6</code> – has an exponential decay constant λ = ln(10/6) / 4 = 0.1277. The interpolated value for day 2 is therefore 10 x e-0.1277 = 8.801, and the full interpolated time series is: <code>10.000, 8.801, 7.746, 6.817, 6.000</code>. Like the <code>linear</code> method, however, it is unable to infill gaps at the beginning or end of a time series. Furthermore, the <code>exponential</code> method will fail if the flow value immediately before or after a gap is 0 (or negative).</p>
<p>The <code>equipercentile</code> method uses measured flows at a donor site to estimate missing flows at a target site. Specifically, the percentile value of the donor flow on any given day is assumed equal to the percentile value of the target flow. Gaps are infilled by calculating the donor flow percentile values and using the existing target flow data to derive the flow equivalent to this percentile value at the target site (for details see Hughes and Smakhtin 1996).</p>
<p>The donor site to be used for each target site can be specified by the user (via the <code>donors</code> argument). If <code>donors = NULL</code>, then the function finds the site in <code>data</code> whose flows are most strongly correlated (using Spearman’s rank correlation coefficient) with those at the target site, and uses that as the donor site. Note that this automated method does not guarantee that the donor site identified will be suitable; indeed, the donor site may be very unsuitable if none of the other sites are climatologically and hydrologically similar to the target site. To mitigate the risk of poor imputation, the function requires that paired target and donor sites have a minimum of 365 overlapping measured flow records. If this condition is not met and a donor site cannot be identified, then the function provides a warning message listing the sites affected.</p>
<p>The interpolation methods have the benefit of simplicity and typically perform best when used to infill relatively short gaps – i.e. intervals where it is reasonable to assume that flows are stable or changing linearly or exponentially over time. The equipercentile method can be better than interpolation at infilling longer gaps, during which flows may change abruptly in response to rainfall events, but its performance is critically dependent on the suitability of the donor site. Donor sites should be hydrologically similar to, and have flows which are strongly correlated with, the target site. If these conditions are not met, then the equipercentile method can produce very imprecise or biased imputed values. When a suitable donor site is used, the equipercentile method has been demonstrated to be superior to many other imputation techniques (including catchment area scaling, long-term mean scaling, and linear regression methods using a single donor site) and to perform similarly to multiple regression using two donor sites (Harvey et al. 2012).</p>
<p>The function applies just one, chosen method at a time, with no default to fall-back methods. If the first method fails to infill all the gaps, then the function can be run a second time, with a different chosen method, to try to infill the remaining gaps, and so on. This iterative approach provides flexibility to determine the sequence in which methods are applied.</p>
<p>The <code>linear</code> and <code>exponential</code> methods can be applied to a single site, but the <code>equipercentile</code> method requires a minimum of two sites (each site acting as a donor for the other).</p>
<p>When processing data for multiple sites, it is recommended that the sites have flow data that span a common time period. This is not essential, however, as the function identifies the earliest and latest dates (across all sites), and ‘expands’ the output dataset to cover all dates for all sites. If flow cannot be imputed for a certain date, then the flow value returned is <code>NA</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># simulate a year of daily flows for three sites</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">flow1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/arima.sim.html" class="external-link">arima.sim</a></span><span class="op">(</span>model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ar <span class="op">=</span> <span class="fl">0.97</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">365</span><span class="op">)</span> <span class="op">+</span> <span class="fl">7</span></span></span>
<span class="r-in"><span><span class="va">flow2</span> <span class="op">&lt;-</span> <span class="va">flow1</span> <span class="op">+</span> <span class="fl">3</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">*</span><span class="va">pi</span>,length.out<span class="op">=</span><span class="fl">365</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">flow3</span> <span class="op">&lt;-</span> <span class="va">flow1</span> <span class="op">+</span> <span class="fl">3</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">*</span><span class="va">pi</span>,length.out<span class="op">=</span><span class="fl">365</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># combine into a dataframe</span></span></span>
<span class="r-in"><span><span class="va">flow_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>flow_site_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">365</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                        date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2021-01-01"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2021-12-31"</span><span class="op">)</span>, by <span class="op">=</span> <span class="st">"1 day"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                        flow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">flow1</span>, <span class="va">flow2</span>, <span class="va">flow3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                        stringsAsFactors<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># create missing data for site A during January</span></span></span>
<span class="r-in"><span><span class="va">flow_data</span><span class="op">$</span><span class="va">flow</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">18</span><span class="op">:</span><span class="fl">27</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot data for January</span></span></span>
<span class="r-in"><span><span class="va">flow_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">date</span> <span class="op">&gt;=</span> <span class="st">"2021-01-01"</span> <span class="op">&amp;</span> <span class="va">date</span> <span class="op">&lt;=</span> <span class="st">"2021-01-31"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">flow</span>, group <span class="op">=</span> <span class="va">flow_site_id</span>, colour <span class="op">=</span> <span class="va">flow_site_id</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="impute_flow-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># impute flows using linear method</span></span></span>
<span class="r-in"><span><span class="va">imp_lin</span> <span class="op">&lt;-</span> <span class="fu">impute_flow</span><span class="op">(</span>data <span class="op">=</span> <span class="va">flow_data</span>,</span></span>
<span class="r-in"><span>                       site_col <span class="op">=</span> <span class="st">"flow_site_id"</span>,</span></span>
<span class="r-in"><span>                       date_col <span class="op">=</span> <span class="st">"date"</span>,</span></span>
<span class="r-in"><span>                       flow_col <span class="op">=</span> <span class="st">"flow"</span>,</span></span>
<span class="r-in"><span>                       method <span class="op">=</span> <span class="st">"linear"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>flow data contains negative values</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Saving 6.67 x 6.67 in image</span>
<span class="r-in"><span><span class="va">imp_lin</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">31</span>,<span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          date flow_site_id      flow imputed method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  2021-01-01            A  8.240111       0   &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  2021-01-02            A  7.540465       0   &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  2021-01-03            A  6.191899       0   &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  2021-01-04            A  6.493466       0   &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  2021-01-05            A  7.594195       0   &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  2021-01-06            A  5.933651       0   &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  2021-01-07            A  5.508461       0   &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  2021-01-08            A  7.014379       0   &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  2021-01-09            A  5.341415       0   &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 2021-01-10            A  6.952269       0   &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 2021-01-11            A  5.460330       0   &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 2021-01-12            A  4.324071       0   &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 2021-01-13            A  4.047762       0   &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 2021-01-14            A  3.220689       0   &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 2021-01-15            A  4.183554       0   &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 2021-01-16            A  3.778440       0   &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 2021-01-17            A  4.603070       0   &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 2021-01-18            A  5.215858       1 Linear</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 2021-01-19            A  5.828645       1 Linear</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 2021-01-20            A  6.441433       1 Linear</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 2021-01-21            A  7.054221       1 Linear</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22 2021-01-22            A  7.667008       1 Linear</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23 2021-01-23            A  8.279796       1 Linear</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24 2021-01-24            A  8.892583       1 Linear</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25 2021-01-25            A  9.505371       1 Linear</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26 2021-01-26            A 10.118159       1 Linear</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27 2021-01-27            A 10.730946       1 Linear</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28 2021-01-28            A 11.343734       0   &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29 2021-01-29            A 10.908792       0   &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30 2021-01-30            A 10.674158       0   &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31 2021-01-31            A 11.533362       0   &lt;NA&gt;</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># impute flows using exponential method</span></span></span>
<span class="r-in"><span><span class="va">imp_exp</span> <span class="op">&lt;-</span> <span class="fu">impute_flow</span><span class="op">(</span>data <span class="op">=</span> <span class="va">flow_data</span>,</span></span>
<span class="r-in"><span>                       site_col <span class="op">=</span> <span class="st">"flow_site_id"</span>,</span></span>
<span class="r-in"><span>                       date_col <span class="op">=</span> <span class="st">"date"</span>,</span></span>
<span class="r-in"><span>                       flow_col <span class="op">=</span> <span class="st">"flow"</span>,</span></span>
<span class="r-in"><span>                       method <span class="op">=</span> <span class="st">"exponential"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>flow data contains negative values</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Saving 6.67 x 6.67 in image</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>NaNs produced</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>NaNs produced</span>
<span class="r-in"><span><span class="va">imp_exp</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">31</span>,<span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          date flow_site_id      flow imputed      method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  2021-01-01            A  8.240111       0        &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  2021-01-02            A  7.540465       0        &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  2021-01-03            A  6.191899       0        &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  2021-01-04            A  6.493466       0        &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  2021-01-05            A  7.594195       0        &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  2021-01-06            A  5.933651       0        &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  2021-01-07            A  5.508461       0        &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  2021-01-08            A  7.014379       0        &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  2021-01-09            A  5.341415       0        &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 2021-01-10            A  6.952269       0        &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 2021-01-11            A  5.460330       0        &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 2021-01-12            A  4.324071       0        &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 2021-01-13            A  4.047762       0        &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 2021-01-14            A  3.220689       0        &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 2021-01-15            A  4.183554       0        &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 2021-01-16            A  3.778440       0        &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 2021-01-17            A  4.603070       0        &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 2021-01-18            A  4.996403       1 Exponential</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 2021-01-19            A  5.423346       1 Exponential</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 2021-01-20            A  5.886771       1 Exponential</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 2021-01-21            A  6.389796       1 Exponential</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22 2021-01-22            A  6.935805       1 Exponential</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23 2021-01-23            A  7.528470       1 Exponential</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24 2021-01-24            A  8.171779       1 Exponential</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25 2021-01-25            A  8.870058       1 Exponential</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26 2021-01-26            A  9.628005       1 Exponential</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27 2021-01-27            A 10.450719       1 Exponential</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28 2021-01-28            A 11.343734       0        &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29 2021-01-29            A 10.908792       0        &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30 2021-01-30            A 10.674158       0        &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31 2021-01-31            A 11.533362       0        &lt;NA&gt;</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># impute flows for site A using automatically selected donor site (B)</span></span></span>
<span class="r-in"><span><span class="va">imp_donorB</span> <span class="op">&lt;-</span> <span class="fu">impute_flow</span><span class="op">(</span>data <span class="op">=</span> <span class="va">flow_data</span>,</span></span>
<span class="r-in"><span>                          site_col <span class="op">=</span> <span class="st">"flow_site_id"</span>,</span></span>
<span class="r-in"><span>                          date_col <span class="op">=</span> <span class="st">"date"</span>,</span></span>
<span class="r-in"><span>                          flow_col <span class="op">=</span> <span class="st">"flow"</span>,</span></span>
<span class="r-in"><span>                          method <span class="op">=</span> <span class="st">"equipercentile"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>flow data contains negative values</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Saving 6.67 x 6.67 in image</span>
<span class="r-in"><span><span class="va">imp_donorB</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">31</span>,<span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          date flow_site_id      flow donor_site donor_flow imputed</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  2021-01-01            A  8.240111          B   8.240111       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  2021-01-02            A  7.540465          B   7.592247       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  2021-01-03            A  6.191899          B   6.295447       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  2021-01-04            A  6.493466          B   6.648750       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  2021-01-05            A  7.594195          B   7.801169       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  2021-01-06            A  5.933651          B   6.192252       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  2021-01-07            A  5.508461          B   5.818613       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  2021-01-08            A  7.014379          B   7.375989       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  2021-01-09            A  5.341415          B   5.754376       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 2021-01-10            A  6.952269          B   7.416457       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 2021-01-11            A  5.460330          B   5.975607       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 2021-01-12            A  4.324071          B   4.890284       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 2021-01-13            A  4.047762          B   4.664742       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 2021-01-14            A  3.220689          B   3.888252       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 2021-01-15            A  4.183554          B   4.901501       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 2021-01-16            A  3.778440          B   4.546557       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 2021-01-17            A  4.603070          B   5.421129       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 2021-01-18            A  5.932530          B   4.923421       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 2021-01-19            A  6.194372          B   5.404926       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 2021-01-20            A  7.769979          B   7.343085       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 2021-01-21            A  9.148157          B   8.863888       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22 2021-01-22            A  9.501712          B   9.299434       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23 2021-01-23            A  9.659034          B   9.512599       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24 2021-01-24            A 10.511001          B  11.202858       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25 2021-01-25            A 10.004909          B  10.194329       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26 2021-01-26            A 10.445064          B  10.844103       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27 2021-01-27            A 10.036617          B  10.259928       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28 2021-01-28            A 11.343734          B  12.691845       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29 2021-01-29            A 10.908792          B  12.302962       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30 2021-01-30            A 10.674158          B  12.113971       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31 2021-01-31            A 11.533362          B  13.018389       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1            &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2            &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3            &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4            &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5            &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6            &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7            &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8            &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9            &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10           &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11           &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12           &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13           &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14           &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15           &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16           &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17           &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 Equipercentile</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 Equipercentile</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 Equipercentile</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 Equipercentile</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22 Equipercentile</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23 Equipercentile</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24 Equipercentile</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25 Equipercentile</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26 Equipercentile</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27 Equipercentile</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28           &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29           &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30           &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31           &lt;NA&gt;</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># impute flows for site A using chosen donor site (C)</span></span></span>
<span class="r-in"><span><span class="va">donors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>site <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span><span class="op">)</span>, donor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C"</span><span class="op">)</span>, stringsAsFactors<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">imp_donorC</span> <span class="op">&lt;-</span> <span class="fu">impute_flow</span><span class="op">(</span>data <span class="op">=</span> <span class="va">flow_data</span>,</span></span>
<span class="r-in"><span>                          site_col <span class="op">=</span> <span class="st">"flow_site_id"</span>,</span></span>
<span class="r-in"><span>                          date_col <span class="op">=</span> <span class="st">"date"</span>,</span></span>
<span class="r-in"><span>                          flow_col <span class="op">=</span> <span class="st">"flow"</span>,</span></span>
<span class="r-in"><span>                          method <span class="op">=</span> <span class="st">"equipercentile"</span>,</span></span>
<span class="r-in"><span>                          donor <span class="op">=</span> <span class="va">donors</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>flow data contains negative values</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Saving 6.67 x 6.67 in image</span>
<span class="r-in"><span><span class="va">imp_donorC</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">31</span>,<span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          date flow_site_id      flow donor_site donor_flow imputed</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  2021-01-01            A  8.240111          C  11.240111       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  2021-01-02            A  7.540465          C  10.540018       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  2021-01-03            A  6.191899          C   9.190111       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  2021-01-04            A  6.493466          C   9.489444       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  2021-01-05            A  7.594195          C  10.587047       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  2021-01-06            A  5.933651          C   8.922485       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  2021-01-07            A  5.508461          C   8.492386       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  2021-01-08            A  7.014379          C   9.992506       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  2021-01-09            A  5.341415          C   8.312857       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 2021-01-10            A  6.952269          C   9.916140       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 2021-01-11            A  5.460330          C   8.415747       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12 2021-01-12            A  4.324071          C   7.270154       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13 2021-01-13            A  4.047762          C   6.983633       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14 2021-01-14            A  3.220689          C   6.145473       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15 2021-01-15            A  4.183554          C   7.096379       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16 2021-01-16            A  3.778440          C   6.678439       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17 2021-01-17            A  4.603070          C   7.489379       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 2021-01-18            A  6.341862          C   6.927424       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 2021-01-19            A  7.178687          C   7.344083       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 2021-01-20            A  9.957814          C   9.216820       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 2021-01-21            A 10.926804          C  10.671642       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22 2021-01-22            A 11.300468          C  11.040668       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23 2021-01-23            A 11.466538          C  11.186795       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24 2021-01-24            A 12.271444          C  12.809516       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25 2021-01-25            A 11.758524          C  11.732971       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26 2021-01-26            A 12.034810          C  12.314271       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27 2021-01-27            A 11.730913          C  11.661184       1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28 2021-01-28            A 11.343734          C  14.023771       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29 2021-01-29            A 10.908792          C  13.565160       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30 2021-01-30            A 10.674158          C  13.306067       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31 2021-01-31            A 11.533362          C  14.140026       0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1            &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2            &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3            &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4            &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5            &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6            &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7            &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8            &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9            &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10           &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11           &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12           &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13           &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14           &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15           &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16           &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17           &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18 Equipercentile</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19 Equipercentile</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20 Equipercentile</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21 Equipercentile</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22 Equipercentile</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23 Equipercentile</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24 Equipercentile</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25 Equipercentile</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26 Equipercentile</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27 Equipercentile</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28           &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29           &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30           &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31           &lt;NA&gt;</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># combine four sets of imputation results</span></span></span>
<span class="r-in"><span><span class="va">imp_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>imp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"imp_lin"</span>, <span class="st">"imp_exp"</span>, <span class="st">"imp_donerB"</span>, <span class="st">"imp_donerC"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">365</span><span class="op">*</span><span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">imp_lin</span>, <span class="va">imp_exp</span>, <span class="va">imp_donorB</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">6</span>,<span class="fl">7</span><span class="op">)</span><span class="op">]</span>, <span class="va">imp_donorC</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">6</span>,<span class="fl">7</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># filter data for plotting</span></span></span>
<span class="r-in"><span><span class="va">imp_plot</span> <span class="op">&lt;-</span> <span class="va">imp_all</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">flow_site_id</span> <span class="op">==</span> <span class="st">"A"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">date</span> <span class="op">&gt;=</span> <span class="st">"2021-01-01"</span> <span class="op">&amp;</span> <span class="va">date</span> <span class="op">&lt;=</span> <span class="st">"2021-01-31"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># compare imputed values for site A</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">imp_plot</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">flow</span>, group <span class="op">=</span> <span class="va">imp</span>, colour <span class="op">=</span> <span class="va">imp</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">flow_data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">31</span>,<span class="op">]</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">flow</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"method"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="impute_flow-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by APEM-Ltd.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

