<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="The import_inv function imports macroinvertebrate sampling data from the Environment Agency's Ecology and Fish Data Explorer (EDE). The data can either be downloaded automatically in .parquet or .csv format, or read in from a previously saved .csv or .rds file. The data can be optionally filtered by site ID and sample date, and the filtered data saved as a .rds file."><title>Importing macroinvertebrate sampling data from the EA Ecology and Fish Data Explorer — import_inv • hetoolkit</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Importing macroinvertebrate sampling data from the EA Ecology and Fish Data Explorer — import_inv"><meta property="og:description" content="The import_inv function imports macroinvertebrate sampling data from the Environment Agency's Ecology and Fish Data Explorer (EDE). The data can either be downloaded automatically in .parquet or .csv format, or read in from a previously saved .csv or .rds file. The data can be optionally filtered by site ID and sample date, and the filtered data saved as a .rds file."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">hetoolkit</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/CaseStudy1.html">HE Toolkit Case Study: macroinvertebrates in chalk streams</a>
    <a class="dropdown-item" href="../articles/CaseStudy2.html">HE Toolkit Case Study: macroinvertebrates in upland rivers</a>
    <a class="dropdown-item" href="../articles/hetoolkit-vignette.html">hetoolkit-Vignette</a>
    <a class="dropdown-item" href="../articles/Resources.html">Resources</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Importing macroinvertebrate sampling data from the EA Ecology and Fish Data Explorer</h1>
      
      <div class="d-none name"><code>import_inv.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The <code>import_inv</code> function imports macroinvertebrate sampling data from the Environment Agency's Ecology and Fish Data Explorer (EDE). The data can either be downloaded automatically in .parquet or .csv format, or read in from a previously saved .csv or .rds file. The data can be optionally filtered by site ID and sample date, and the filtered data saved as a .rds file.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">import_inv</span><span class="op">(</span>source <span class="op">=</span> <span class="st">"parquet"</span>, sites <span class="op">=</span> <span class="cn">NULL</span>, start_date <span class="op">=</span> <span class="cn">NULL</span>, end_date <span class="op">=</span> <span class="cn">NULL</span>, save <span class="op">=</span> <span class="cn">FALSE</span>, save_dwnld <span class="op">=</span> <span class="cn">FALSE</span>, save_dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span>, biol_dir <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>source</dt>
<dd><p>Specify source of macroinvertebrate data: "parquet" or "csv" to automatically download data from EDE, or provide path to local .csv, .rds or .parquet file. (Alternatively set <code>source = NULL</code> and instead use deprecated <code>biol_dir</code> argument to provide path to local file). Default = "parquet".</p></dd>


<dt>sites</dt>
<dd><p>Vector of site ids to filter by.</p></dd>


<dt>start_date</dt>
<dd><p>Required start date (in <code>yyyy-mm-dd</code> format); older records are filtered out. Default = <code>NULL</code> to keep all available data.</p></dd>


<dt>end_date</dt>
<dd><p>Required end date (in <code>yyyy-mm-dd</code> format); more recent records are filtered out. Default = <code>NULL</code> to keep all available data.</p></dd>


<dt>save</dt>
<dd><p>Specifies whether (<code>TRUE</code>) or not (<code>FALSE</code>) the filtered data should be saved as an rds file (for future use, or audit trail). Default = <code>FALSE</code>.</p></dd>


<dt>save_dwnld</dt>
<dd><p>Specifies whether (<code>TRUE</code>) or not (<code>FALSE</code>) the unfiltered parquet or csv file download should be saved, in .rds format. Default = <code>FALSE</code>.</p></dd>


<dt>save_dir</dt>
<dd><p>Path to folder where downloaded and/or filtered data are to be saved. Default = Current working directory.</p></dd>


<dt>biol_dir</dt>
<dd><p>Deprecated. Path to local .csv, .rds or parquet file containing macroinvertebrate data. Default = <code>NULL</code> (download data from EDE).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Tibble containing imported macroinvertebrate data.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>If automatically downloading data from EDE, the parquet file format is faster to download than csv, and has data types pre-formatted.</p>
<p>If saving a copy of the downloaded data, the name of the rds file is hard-wired to <code>INV_OPEN_DATA_METRICS_ALL.RDS</code>. If saving after filtering on site and/or date, the name of the rds file is hard-wired to <code>INV_OPEN_DATA_METRICS_F.RDS</code>.</p>
<p>Downloaded raw data files (in .parquet and .csv format) will be automatically removed from the working directory following completed execution of the function.</p>
<p>The function automatically modifies the output from EDE, renaming "SITE_ID" to "biol_site_id" (<code>hetoolkit</code>'s standardised column header for biology site ids).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Bulk download of EDE data for all sites in parquet format and save as .rds file for future use:</span></span></span>
<span class="r-in"><span><span class="co"># import_inv(save_dwnld = TRUE, save_dir = getwd())</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Bulk download of EDE data for all sites in parquet format:</span></span></span>
<span class="r-in"><span><span class="co"># import_inv(source = "csv")</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Read in local .rds file and filter on selected sites and dates (up to the present day):</span></span></span>
<span class="r-in"><span><span class="co"># import_inv(source = "data/INV_OPEN_DATA_METRICS_ALL.rds",</span></span></span>
<span class="r-in"><span><span class="co">#                sites = c("34310", "34343"),</span></span></span>
<span class="r-in"><span><span class="co">#                start_date = "1995-01-01",</span></span></span>
<span class="r-in"><span><span class="co">#                end_date = Sys.Date())</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Read in local .csv file, filter on selected sites, and save the result as a .rds file:</span></span></span>
<span class="r-in"><span><span class="co"># import_inv(source = "data/INV_OPEN_DATA_METRICS.csv",</span></span></span>
<span class="r-in"><span><span class="co">#          sites = c("34310", "34343"),</span></span></span>
<span class="r-in"><span><span class="co">#          save = TRUE,</span></span></span>
<span class="r-in"><span><span class="co">#          save_dir = getwd())</span></span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by APEM-Ltd.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

